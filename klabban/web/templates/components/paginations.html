{% macro render_pagination(pagination, endpoint, key_page='page', kwargs={}) %}
{% if pagination.pages > 1 %}
<div class="flex flex-col sm:flex-row items-center justify-between mt-6 gap-4">
  <!-- ข้อมูลจำนวนรายการ -->
  <div class="text-sm text-gray-600 order-2 sm:order-1">
    <span class="hidden sm:inline">แสดง</span>
    <span class="font-semibold text-gray-800">{{ (pagination.page - 1) * pagination.per_page + 1 }}-{{ (pagination.page - 1) * pagination.per_page + pagination.items|length }}</span> 
    <span class="hidden sm:inline">จาก</span>
    <span class="sm:hidden">/</span>
    <span class="font-semibold text-gray-800">{{ pagination.total }}</span>
    <span class="hidden sm:inline">รายการ</span>
  </div>
  
  <!-- ปุ่ม Pagination -->
  <nav class="flex items-center gap-1 order-1 sm:order-2" aria-label="Pagination">
    <!-- Previous Page Button -->
    {% if pagination.has_prev %}
      {% set prev_args = kwargs.copy() %}
      {% set _ = prev_args.update({key_page: pagination.prev_num}) %}
      <a href="{{ url_for(endpoint, **prev_args) }}" 
         class="flex items-center justify-center w-10 h-10 sm:w-auto sm:h-auto sm:px-4 sm:py-2 rounded-lg bg-gray-100 hover:bg-primary hover:text-white transition-colors duration-200 text-gray-700 font-medium">
        <i class="ph ph-caret-left text-lg"></i>
        <span class="hidden sm:inline ml-1">ก่อนหน้า</span>
      </a>
    {% else %}
      <span class="flex items-center justify-center w-10 h-10 sm:w-auto sm:h-auto sm:px-4 sm:py-2 rounded-lg bg-gray-100 text-gray-400 cursor-not-allowed">
        <i class="ph ph-caret-left text-lg"></i>
        <span class="hidden sm:inline ml-1">ก่อนหน้า</span>
      </span>
    {% endif %}

    <!-- Page Numbers -->
    {% set start_page = [1, pagination.page - 1]|max %}
    {% set end_page = [pagination.pages, pagination.page + 1]|min %}
    
    <!-- First page if not in range -->
    {% if start_page > 1 %}
      {% set first_args = kwargs.copy() %}
      {% set _ = first_args.update({key_page: 1}) %}
      <a href="{{ url_for(endpoint, **first_args) }}" 
         class="hidden sm:flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 hover:bg-primary hover:text-white transition-colors duration-200 text-gray-700 font-medium">1</a>
      {% if start_page > 2 %}
        <span class="hidden sm:flex items-center justify-center w-10 h-10 text-gray-400">...</span>
      {% endif %}
    {% endif %}

    <!-- Page range -->
    {% for page_num in range(start_page, end_page + 1) %}
      {% if page_num == pagination.page %}
        <span class="flex items-center justify-center min-w-10 h-10 px-3 rounded-lg bg-primary text-white font-semibold shadow-md">{{ page_num }}</span>
      {% else %}
        {% set page_args = kwargs.copy() %}
        {% set _ = page_args.update({key_page: page_num}) %}
        <a href="{{ url_for(endpoint, **page_args) }}" 
           class="hidden sm:flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 hover:bg-primary hover:text-white transition-colors duration-200 text-gray-700 font-medium">{{ page_num }}</a>
      {% endif %}
    {% endfor %}

    <!-- Mobile: แสดง / จำนวนหน้า -->
    <span class="flex sm:hidden items-center text-sm text-gray-500 mx-2">/ {{ pagination.pages }}</span>

    <!-- Last page if not in range -->
    {% if end_page < pagination.pages %}
      {% if end_page < pagination.pages - 1 %}
        <span class="hidden sm:flex items-center justify-center w-10 h-10 text-gray-400">...</span>
      {% endif %}
      {% set last_args = kwargs.copy() %}
      {% set _ = last_args.update({key_page: pagination.pages}) %}
      <a href="{{ url_for(endpoint, **last_args) }}" 
         class="hidden sm:flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 hover:bg-primary hover:text-white transition-colors duration-200 text-gray-700 font-medium">{{ pagination.pages }}</a>
    {% endif %}

    <!-- Next Page Button -->
    {% if pagination.has_next %}
      {% set next_args = kwargs.copy() %}
      {% set _ = next_args.update({key_page: pagination.next_num}) %}
      <a href="{{ url_for(endpoint, **next_args) }}" 
         class="flex items-center justify-center w-10 h-10 sm:w-auto sm:h-auto sm:px-4 sm:py-2 rounded-lg bg-gray-100 hover:bg-primary hover:text-white transition-colors duration-200 text-gray-700 font-medium">
        <span class="hidden sm:inline mr-1">ถัดไป</span>
        <i class="ph ph-caret-right text-lg"></i>
      </a>
    {% else %}
      <span class="flex items-center justify-center w-10 h-10 sm:w-auto sm:h-auto sm:px-4 sm:py-2 rounded-lg bg-gray-100 text-gray-400 cursor-not-allowed">
        <span class="hidden sm:inline mr-1">ถัดไป</span>
        <i class="ph ph-caret-right text-lg"></i>
      </span>
    {% endif %}
  </nav>
</div>
{% endif %}
{% endmacro %}

{% macro render_simple_pagination(pagination, endpoint, key_page='page', kwargs={}) %}
{% if pagination.pages > 1 %}
<div class="flex items-center justify-center mt-6">
  <nav class="flex items-center gap-2" aria-label="Pagination">
    <!-- Previous Page Button -->
    {% if pagination.has_prev %}
      {% set prev_args = kwargs.copy() %}
      {% set _ = prev_args.update({key_page: pagination.prev_num}) %}
      <a href="{{ url_for(endpoint, **prev_args) }}" 
         class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 hover:bg-primary hover:text-white transition-colors duration-200 text-gray-700 shadow-sm active:scale-95">
        <i class="ph ph-caret-left text-xl"></i>
      </a>
    {% else %}
      <span class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 text-gray-300 cursor-not-allowed">
        <i class="ph ph-caret-left text-xl"></i>
      </span>
    {% endif %}

    <!-- Current Page Info -->
    <div class="flex items-center gap-1 px-4 py-2 bg-primary text-white rounded-full font-semibold shadow-md">
      <span class="text-lg">{{ pagination.page }}</span>
      <span class="text-sm opacity-75">/ {{ pagination.pages }}</span>
    </div>

    <!-- Next Page Button -->
    {% if pagination.has_next %}
      {% set next_args = kwargs.copy() %}
      {% set _ = next_args.update({key_page: pagination.next_num}) %}
      <a href="{{ url_for(endpoint, **next_args) }}" 
         class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 hover:bg-primary hover:text-white transition-colors duration-200 text-gray-700 shadow-sm active:scale-95">
        <i class="ph ph-caret-right text-xl"></i>
      </a>
    {% else %}
      <span class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 text-gray-300 cursor-not-allowed">
        <i class="ph ph-caret-right text-xl"></i>
      </span>
    {% endif %}
  </nav>
</div>
{% endif %}
{% endmacro %}

{% macro render_pagination_with_size(pagination, endpoint, key_page='page', key_per_page='per_page', kwargs={}) %}
<div class="flex flex-col gap-4 mt-6">
  <!-- Row 1: Per page selector & Info -->
  <div class="flex flex-col sm:flex-row items-center justify-between gap-3">
    <div class="flex items-center gap-3">
      <span class="text-sm text-gray-600">แสดงต่อหน้า:</span>
      <select class="select select-bordered select-sm rounded-lg bg-white border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20" 
              onchange="window.location.href = updateUrlParam('{{ key_per_page }}', this.value)">
        {% for size in [10, 20, 50, 100] %}
          <option value="{{ size }}" {% if pagination.per_page == size %}selected{% endif %}>
            {{ size }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div class="text-sm text-gray-600">
      <span class="hidden sm:inline">แสดง</span>
      <span class="font-semibold text-gray-800">{{ (pagination.page - 1) * pagination.per_page + 1 }}-{{ (pagination.page - 1) * pagination.per_page + pagination.items|length }}</span> 
      <span class="hidden sm:inline">จาก</span>
      <span class="sm:hidden">/</span>
      <span class="font-semibold text-gray-800">{{ pagination.total }}</span>
      <span class="hidden sm:inline">รายการ</span>
    </div>
  </div>
  
  <!-- Row 2: Pagination buttons -->
  {% if pagination.pages > 1 %}
  <div class="flex justify-center">
    <nav class="flex items-center gap-1" aria-label="Pagination">
      <!-- Previous -->
      {% if pagination.has_prev %}
        {% set prev_args = kwargs.copy() %}
        {% set _ = prev_args.update({key_page: pagination.prev_num}) %}
        <a href="{{ url_for(endpoint, **prev_args) }}" 
           class="flex items-center justify-center w-10 h-10 sm:w-auto sm:h-auto sm:px-4 sm:py-2 rounded-lg bg-gray-100 hover:bg-primary hover:text-white transition-colors duration-200 text-gray-700 font-medium">
          <i class="ph ph-caret-left text-lg"></i>
          <span class="hidden sm:inline ml-1">ก่อนหน้า</span>
        </a>
      {% else %}
        <span class="flex items-center justify-center w-10 h-10 sm:w-auto sm:h-auto sm:px-4 sm:py-2 rounded-lg bg-gray-100 text-gray-400 cursor-not-allowed">
          <i class="ph ph-caret-left text-lg"></i>
          <span class="hidden sm:inline ml-1">ก่อนหน้า</span>
        </span>
      {% endif %}

      {% set start_page = [1, pagination.page - 1]|max %}
      {% set end_page = [pagination.pages, pagination.page + 1]|min %}
      
      {% for page_num in range(start_page, end_page + 1) %}
        {% if page_num == pagination.page %}
          <span class="flex items-center justify-center min-w-10 h-10 px-3 rounded-lg bg-primary text-white font-semibold shadow-md">{{ page_num }}</span>
        {% else %}
          {% set page_args = kwargs.copy() %}
          {% set _ = page_args.update({key_page: page_num}) %}
          <a href="{{ url_for(endpoint, **page_args) }}" 
             class="hidden sm:flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 hover:bg-primary hover:text-white transition-colors duration-200 text-gray-700 font-medium">{{ page_num }}</a>
        {% endif %}
      {% endfor %}

      <!-- Mobile: แสดง / จำนวนหน้า -->
      <span class="flex sm:hidden items-center text-sm text-gray-500 mx-2">/ {{ pagination.pages }}</span>

      <!-- Next -->
      {% if pagination.has_next %}
        {% set next_args = kwargs.copy() %}
        {% set _ = next_args.update({key_page: pagination.next_num}) %}
        <a href="{{ url_for(endpoint, **next_args) }}" 
           class="flex items-center justify-center w-10 h-10 sm:w-auto sm:h-auto sm:px-4 sm:py-2 rounded-lg bg-gray-100 hover:bg-primary hover:text-white transition-colors duration-200 text-gray-700 font-medium">
          <span class="hidden sm:inline mr-1">ถัดไป</span>
          <i class="ph ph-caret-right text-lg"></i>
        </a>
      {% else %}
        <span class="flex items-center justify-center w-10 h-10 sm:w-auto sm:h-auto sm:px-4 sm:py-2 rounded-lg bg-gray-100 text-gray-400 cursor-not-allowed">
          <span class="hidden sm:inline mr-1">ถัดไป</span>
          <i class="ph ph-caret-right text-lg"></i>
        </span>
      {% endif %}
    </nav>
  </div>
  {% endif %}
</div>

<script>
function updateUrlParam(param, value) {
  const url = new URL(window.location);
  url.searchParams.set(param, value);
  url.searchParams.set('{{ key_page }}', 1); 
  return url.toString();
}
</script>
{% endmacro %}
